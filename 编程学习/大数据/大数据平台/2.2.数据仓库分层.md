## 数仓建设背景

- 数据建设刚起步，大部分数据经过粗暴的数据接入后直接对接业务
- 数据建设发展到一定阶段，发现数据的使用杂乱无章，各种业务都是从原始数据直接计算而得。
- 各种重复计算，严重浪费了计算资源，需要优化性能



## 为什么要进行数仓分层
- 清晰数据结构：每个数据分层都有对应的作用域
- 数据血缘追踪：对各层之间的数据表转换为跟踪，建立血缘关系
- 减少重复开发：规范数据分层，开发通用的中间层数据
- 屏蔽原始数据异常的：通过数据分层管控数据质量 
- 屏蔽业务的影响：不必改一次业务就需要重新接入数据 
- 复杂问题简单化：将复杂的数仓架构分解成多个数据层来完成



## 数据仓库的分层

![image-20240531104842517](D:\user\person\notes\编程学习\大数据\大数据平台\assets\image-20240531104842517.png)

### STG层

- 原始数据层：存储原始数据，数据结构与采集数据一致
- 存储周期：保存全部数据
- 表名命名规范：`stg_主题_表内容_分表规则`

### ODS层

- 数据操作层：对STG层数据进行初步处理，如去脏数据，去除无用字段
- 存储周期：默认保留近30天数据
- 表命名规范：`ods_主题_表内容_分表规则`

### DWD层
- 数据明细层：数据处理后的宽表，目标为满足80%的业务需求
- 存储周期：保留历史至今所有的数据
- 表名命规范：`dwd_业务描述_时间粒度`

### DWS层
- 数据汇总层：汇总数据，解决数据汇总计算和数据完整性问题
- 存储周期：保留历史至今所有的数据
- 表名命规范：`dws_业务描述_时间粒度_sum`

### DIM层
- 公共维度层：存储公共的信息数据，用于DWD、DWS的数据关联
- 存储周期：按需存储，一般保留历史至今所有的数据
- 表名命规范：`dim_维度描述`

### DM层
- 数据集集市：用于BI、多维分析、标签、数据挖掘等
- 存储周期：按需存储，一般保留历史至今所有的数据
- 表名命规范：`dm_主题_表内容_分表规则`

## 数仓分层的数据流转

![image-20240531104148570](D:\user\person\notes\编程学习\大数据\大数据平台\assets\image-20240531104148570.png)