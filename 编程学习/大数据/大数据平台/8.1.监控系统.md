## 集群监控&平台监控

开发一个大数据平台不是我们的目的，稳定的对其使用才是

大数据平台的日志和监控是我们开发人员工作中必不可少的两只眼睛

大数据平台涉及到的组件较多，需要统一的完成集群监控和平台监控

## 监控分层

监控粒度、监控指标完整性、监控实时性是评价监控系统的三要素

一般我们将监控系统分为三个层次：系统层、应用层和业务层

### 监控分层之系统层

系统层即我们的大数据平台所依赖的服务器层级的监控

实时掌握服务器工作状态，留意性能、内存消耗、容量和整体系统健康状态，保证服务器稳定运行

监控指标：内存、磁盘、CPU、网络流量、系统进程等系统级指标

### 监控分层之应用层

应用层顾名思义为在服务器上部署的各类的应用，包括但不限于我们的Hadoop集群、Azkaban调度服务和我们的大数据平台应用等等

对应用的整体运行状况进行了解、把控，确保服务状态正常，服务性能正常

常用监控数据：JVM堆内存、GC、CPU使用率、线程数、TPS、吞吐量等

### 监控分层之业务层
业务层监控是最贴近系统用户的，同时可以反馈系统及应用层的问题

对业务数据进行监控，可及时发现程序bug或业务逻辑设计缺陷

比如我们会监控Azkaban的任务执行情况、Datax数据抽取情况等等



## 开源监控项目对比

### 监控组件评判标准

- 监控粒度、监控指标完整度、监控数据实时性

- 面向的监控对象、监控对象是否可扩展、监控项是否可扩展

- 数据的采集方式、存储方式、展示方式、报警方式

### 常见的开源监控组件

Zabbix：基于Web界面提供分布式系统监视及网络监视功能的企业级开源解决方案

OpenFalcon：小米开源的面向互联网企业的监控产品

Prometheus：Prometheus是一套开源的监控&报警&时间序列数据库的组合

#### Zabbix

![image-20240724105626617](D:\user\person\notes\编程学习\大数据\大数据平台\assets\image-20240724105626617.png)

#### OpenFalcon

![image-20240724105725617](D:\user\person\notes\编程学习\大数据\大数据平台\assets\image-20240724105725617.png)

#### Prometheus

![image-20240724105805782](D:\user\person\notes\编程学习\大数据\大数据平台\assets\image-20240724105805782.png)

### 开源监控方案对比

|              | Zabbix            | OpenFalcon                        | Prometheus                               |
| ------------ | ----------------- | --------------------------------- | ---------------------------------------- |
| 可扩展性     | 可扩展能力强      | 可扩展能力强                      | 可扩展能力强                             |
| 监控数据采集 | 推送&拉取         | 推送&拉取                         | 推送&拉取                                |
| 监控数据存储 | mysql/psql        | 归档RD，存储 mysql+redis+open sdb | 自带时序数据库存储 方案，类似于 OpenTSDB |
| 自定义指标   | C++脚本           | go/python/shell                   | go/python/shell                          |
| 告警功能     | 支持              | 支持                              | 支持                                     |
| 使用场景     | 大中型企业&私有云 | 大中型企业&私有云                 | 大中型企业&私有云                        |