## 运行时数据区域

Java虚拟机在执行Java程序的过程中会把它所管理的内存划分为若干个不同的数据区域。这些区域都有各自的用途，以及创建和销毁的时间，有的区域随着虚拟机进程的启动而存在，有些区域则依赖用户线程的启动和结束而建立和销毁。Java虚拟机所管理的内存将会包括以下几个运行时数据区域，如下图所示。

![Java虚拟机运行时数据区](https://res.weread.qq.com/wrepub/epub_603120_67)



- 程序计数器：程序计数器是线程私有的，可看作当前线程所执行字节码的行号指示器。

- Java虚拟机栈：Java虚拟机栈是线程私有的，每个方法在执行的同时都会创建一个**栈帧**。每一个方法从调用直至执行完成的过程，就对应着一个栈帧在虚拟机栈中入栈到出栈的过程。

  栈帧存储着**局部变量表**、**操作数栈**、**动态链接**、**方法出口**等信息

  局部变量表存放了编译期可知的**各种基本数据类型**（boolean、byte、char、short、int、float、long、double）、**对象引用**（reference类型，它不等同于对象本身，可能是一个指向对象起始地址的引用指针，也可能是指向一个代表对象的句柄或其他与此对象相关的位置）和**returnAddress类型**（指向了一条字节码指令的地址）。

- 本地方法栈：本地方法栈与虚拟机栈所发挥的作用是非常相似的，他们之间的区别不过是虚拟机栈执行Java方法（也就是字节码）服务，而本地方法栈则为虚拟机中的Native方法服务。

- Java堆：Java堆是被所有线程共享的一块内存区域，在虚拟机启动时创建。此内存区域唯一的目的就是存放对象实例。

- 方法区：方法区也是被线程共享的内存区域，它用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译器编译后的代码等数据。

  运行时常量池是方法区的一部分，Class文件中除了有类的版本、字段、方法、接口等描述信息外，还有一项信息是常量池，用于存放编译期生成的各种字面量和符号引用，这部分内容将在类加载后进入方法区的运行时常量池中存放。

## 参考文档

- 深入理解Java虚拟机：JVM高级特性与最佳实践（第2版） 